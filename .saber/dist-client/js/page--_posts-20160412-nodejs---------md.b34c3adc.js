(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{57:function(e,o,s){"use strict";s.r(o);var t=s(0),n=function(e){var o,s,t,n,v,r=(t="post",n="医生看病",v="快餐店点餐",(o={}).internal=s=void 0,o.contentType="markdown",o.slug="20160412-nodejs事件驱动编程理解",o.content=s,o.title="nodejs事件驱动编程理解",o.layout=t,o.markdownHeadings=[{text:"理解Node.js事件驱动编程",slug:"理解node-js事件驱动编程",level:2},{text:"Node.Js是基于javascript语言，建构在google V8 engine以及Linux上的一个非阻塞事件驱动IO框架。nodejs是单进程单线程，但是基于V8的强大驱动力，以及事件驱动模型，nodejs的性能非常高，而且想达到多核或者多进程也不是很难（现在已经有大量的第三方module来实现这个功能）。",slug:"node-js是基于javascript语言，建构在google-v8-engine以及linux上的一个非阻塞事件驱动io框架。nodejs是单进程单线程，但是基于v8的强大驱动力，以及事件驱动模型，nodejs的性能非常高，而且想达到多核或者多进程也不是很难（现在已经有大量的第三方module来实现这个功能）。",level:4},{text:n,slug:n,level:3},{text:v,slug:v,level:3},{text:"Node.Js做了什么工作呢",slug:"node-js做了什么工作呢",level:3}],o.excerpt="<p>Node.js现在非常活跃，相关生态社区已经超过Lua（基本上比较知名的功能都有nodejs模块实现）。</p>\n",o.createdAt=new Date(14604192e5),o.updatedAt=new Date(1568855942172),o.type=t,o.permalink="/posts/20160412-nodejs事件驱动编程理解.html",o.assets={},o.attributes=o,o.prevPost={title:"node基础",permalink:"/posts/20160315-node基础.html"},o.nextPost={title:"AngularJS",permalink:"/posts/20160830-AngularJS.html"},o),a=e.options.beforeCreate||[];e.options.beforeCreate=[function(){this.$page=r}].concat(a);["layout","transition"].forEach((function(o){var s=e.options.PageComponent;s&&(e.options[o]=s[o]),void 0===e.options[o]&&(e.options[o]=r[o])})),e.options.name="page-wrapper-"+r.slug.replace(/[^0-9a-z\-]/i,"-")},v=Object(t.a)({},(function(){var e=this,o=e.$createElement,s=e._self._c||o;return s("layout-manager",[s("h2",{attrs:{id:"理解node-js事件驱动编程"}},[e._v("理解Node.js事件驱动编程")]),e._v(" "),s("p",[e._v("Node.js现在非常活跃，相关生态社区已经超过Lua（基本上比较知名的功能都有nodejs模块实现）。")]),e._v(" "),s("p",[e._v("但是我们为何要使用Node.Js？相比传统的webserver服务模式，nodejs有什么优点优势？")]),e._v(" "),s("h4",{attrs:{id:"node-js是基于javascript语言，建构在google-v8-engine以及linux上的一个非阻塞事件驱动io框架。nodejs是单进程单线程，但是基于v8的强大驱动力，以及事件驱动模型，nodejs的性能非常高，而且想达到多核或者多进程也不是很难（现在已经有大量的第三方module来实现这个功能）。"}},[e._v("Node.Js是基于javascript语言，建构在google V8 engine以及Linux上的一个非阻塞事件驱动IO框架。nodejs是单进程单线程，但是基于V8的强大驱动力，以及事件驱动模型，nodejs的性能非常高，而且想达到多核或者多进程也不是很难（现在已经有大量的第三方module来实现这个功能）。")]),e._v(" "),s("p",[e._v("这里主要不是介绍nodejs具体应用代码，而是想介绍一下事件驱动编程。")]),e._v(" "),s("h3",{attrs:{id:"医生看病"}},[e._v("医生看病")]),e._v(" "),s("p",[e._v("在美国去看医生，需要填写大量表格，比如保险、个人信息之类，传统的基于线程的系统（thread-based system），接待员叫到你，你需要在前台填写完成这些表格，你站着填单，而接待员坐着看你填单。你让接待员没办法接待下一个客户，除非完成你的业务。")]),e._v(" "),s("p",[e._v("想让这个系统能运行的快一些，只有多加几个接待员，人力成本需要增加不少。")]),e._v(" "),s("p",[e._v("基于事件的系统（event-based system）中，当你到窗口发现需要填写一些额外的表格而不仅仅是挂个号，接待员把表格和笔给你，告诉你可以找个座位填写，填完了以后再回去找他。你回去坐着填表，而接待员开始接待下一个客户。你没有阻塞接待员的服务。")]),e._v(" "),s("p",[e._v("你填完表格，返回队伍中，等接待员接待完现在的客户，你把表格递给他。如果有什么问题或者需要填写额外的表格，他给你一份新的，然后重复这个过程。")]),e._v(" "),s("p",[e._v("这个系统已经非常高效了，几乎大部分医生都是这么做的。如果等待的人太多，可以加入额外的接待员进行服务，但是肯定要比基于线程模式的少得多。")]),e._v(" "),s("h3",{attrs:{id:"快餐店点餐"}},[e._v("快餐店点餐")]),e._v(" "),s("p",[e._v("在基于线程的方式中（thread-based way）你到了柜台前，把你的点餐单给收银员或者给收银员直接点餐，然后等在那直到你要的食物准备好给你。收银员不能接待下一个人，除非你拿到食物离开。想接待更多的客户，容易！加更多的收银员！")]),e._v(" "),s("p",[e._v("当然，我们知道快餐店其实不是这样工作的。他们其实就是基于事件驱动方式，这样收银员更高效。只要你把点餐单给收银员，某个人已经开始准备你的食物，而同时收银员在进行收款，当你付完钱，你就站在一边而收银员已经开始接待下一个客户。在一些餐馆，甚至会给你一个号码，如果你的食物准备好了，就呼叫你的号码让你去柜台取。关键的一点是，你没有阻塞下一个客户的订餐请求。你订餐的食物做好的事件会导致某个人做某个动作（某个服务员喊你的订单号码，你听到你的号码被喊到去取食物），在编程领域，我们称这个为回调（callback function）。")]),e._v(" "),s("h3",{attrs:{id:"node-js做了什么工作呢"}},[e._v("Node.Js做了什么工作呢")]),e._v(" "),s("p",[e._v("传统的web server多为基于"),s("strong",[e._v("线程模型")]),e._v("。你启动Apache或者什么server，它开始等待接受连接。当收到一个连接，server保持连接连通直到页面或者什么事务请求完成。如果他需要花几微妙时间去读取磁盘或者访问数据库，web server就阻塞了IO操作（这也被称之为阻塞式IO).想提高这样的web server的性能就只有启动更多的server实例。")]),e._v(" "),s("p",[e._v("相反的，Node.Js使用"),s("strong",[e._v("事件驱动模型")]),e._v("，当web server接收到请求，就把它关闭然后进行处理，然后去服务下一个web请求。当这个请求完成，它被放回处理队列，当到达队列开头，这个结果被返回给用户。这个模型非常高效可扩展性非常强，因为webserver一直接受请求而不等待任何读写操作。（这也被称之为非阻塞式IO或者事件驱动IO）")]),e._v(" "),s("p",[e._v("考虑下面这个过程：")]),e._v(" "),s("ol",[s("li",[s("p",[e._v('你用浏览器访问nodejs服务器上的"/about.html"')])]),e._v(" "),s("li",[s("p",[e._v("nodejs服务器接收到你的请求，调用一个函数从磁盘上读取这个文件。")])]),e._v(" "),s("li",[s("p",[e._v("这段时间，nodejs webserver在服务后续的web请求。")])]),e._v(" "),s("li",[s("p",[e._v("当文件读取完毕，有一个回调函数被插入到nodejs的服务队列中。")])]),e._v(" "),s("li",[s("p",[e._v("nodejs webserver运行这个函数，实际上就是渲染（render）了about.html页面返回给你的浏览器。")])])]),e._v(" "),s("p",[e._v("好像就节省了几微秒时间，但是这很重要！特别是对于需要相应大量用户的web server。")]),e._v(" "),s("p",[e._v("这也就是为什么Node.Js这么热这么惹人关注。而且它还使用了一个非常通用的编程语言Javascript，也让开发者可以快速容易的编写高可扩展性服务器。")])])}),[],!1,null,null,null);"function"==typeof n&&n(v);o.default=v.exports}}]);