(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{93:function(t,s,a){"use strict";a.r(s);var n=a(0),e=function(t){var s,a,n,e,r,p=(n="post",e="eslint在项目中使用",r="修复命令",(s={}).internal=a=void 0,s.contentType="markdown",s.slug="20181028-eslint",s.content=a,s.title="eslint",s.layout=n,s.markdownHeadings=[{text:e,slug:e,level:2},{text:r,slug:r,level:3},{text:"git commit 钩子插件: husky",slug:"git-commit-钩子插件-husky",level:2},{text:"git commit message插件: commitline",slug:"git-commit-message插件-commitline",level:2}],s.excerpt="<p>eslint 可以给我们的代码定义一些语法规范, 防止我们在语法上犯一些低级的错误, 格式上的问题, 团队协作时大家都使用统一的代码风格去书写, 让我们在看别人的代码时更方便.</p>\n",s.createdAt=new Date(15406848e5),s.updatedAt=new Date(1569295132249),s.type=n,s.permalink="/posts/20181028-eslint.html",s.assets={},s.attributes=s,s.prevPost={title:"无状态组件的最佳写法",permalink:"/posts/20180927-无状态组件的最佳写法.html"},s.nextPost={title:"vue-router",permalink:"/posts/20181111-vue-router.html"},s),o=t.options.beforeCreate||[];t.options.beforeCreate=[function(){this.$page=p}].concat(o);["layout","transition"].forEach((function(s){var a=t.options.PageComponent;a&&(t.options[s]=a[s]),void 0===t.options[s]&&(t.options[s]=p[s])})),t.options.name="page-wrapper-"+p.slug.replace(/[^0-9a-z\-]/i,"-")},r=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("layout-manager",[a("h2",{attrs:{id:"eslint在项目中使用"}},[t._v("eslint在项目中使用")]),t._v(" "),a("p",[t._v("eslint 可以给我们的代码定义一些语法规范, 防止我们在语法上犯一些低级的错误, 格式上的问题, 团队协作时大家都使用统一的代码风格去书写, 让我们在看别人的代码时更方便.")]),t._v(" "),a("p",[t._v("在项目中安装依赖")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^5.8.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-config-standard"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^12.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-html"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.0.6"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-import"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^2.14.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-node"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^8.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-promise"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.0.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-react"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^7.11.1"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"eslint-plugin-standard"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"^4.0.0"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])])])]),a("p",[t._v("再添加一个.eslintrc 文件:")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extends"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"standard"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),a("p",[t._v("再在package.json文件中添加 eslint 校验命令")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --ext .js --ext .jsx --ext .vue src"')])])])]),a("h3",{attrs:{id:"修复命令"}},[t._v("修复命令")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"lint-fix"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"eslint --fix --ext .js --ext .jsx --ext .vue src"')])])])]),a("p",[t._v("校验时报错在运行 lint 命令时 jsx 文件报错: Parsing error: Unexpected token =")]),t._v(" "),a("p",[t._v("经过网上查找资料, 再安装一个 babel-eslint 依赖,安装后再在 .eslintrc 文件添加一行")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"extends"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"standard"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"plugins"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"html"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"parse"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"babel-eslint"')]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),a("p",[t._v("一般我们使用webpack 和 babel 进行开发的时候我们都会指定他的 parse 为 babel-eslint, 因为 eslint 对有一些 es6 的语法不是很支持")]),t._v(" "),a("p",[t._v("我们还需要在 webpack 的 module 配置中最开始加上:")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"js"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-js"}},[a("code",{pre:!0,attrs:{class:"language-js"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  test"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/\\.(js|jsx|vue)$/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  loader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'eslint-loader'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  exclude"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token regex"}},[t._v("/node_modules/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为有的 node_modules 文件已经是经过 babel 处理过的, 不符合我们的 es6 或者 es7 规范, 所有剔除")]),t._v("\n  enforce"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pre'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 预处理: 在vue-loader之前就进行检测, 在这几种文件对应的loader处理之前就进行eslint-loader的检测")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")])])])]),a("p",[t._v("此时只是用命令对我们的代码进行检查, 下面是配置编辑器直接在写代码的时候立即提示出有语法问题的代码")]),t._v(" "),a("h2",{attrs:{id:"git-commit-钩子插件-husky"}},[t._v("git commit 钩子插件: husky")]),t._v(" "),a("p",[t._v("在正式的项目中, 我们会有团队协作, 我们可以在git commit 的对应 hook 进行 eslint 的检查, 首先要安装 husky:")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"shell"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-shell"}},[a("code",{pre:!0,attrs:{class:"language-shell"}},[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" husky -D")])])]),a("p",[t._v("注意: 在安装一些git hook 工具的时候, npm install 之前, 项目跟目录一定要是一个git 仓库, 这样对应的工具才能初始化成功, 不然会有问题,")]),t._v(" "),a("p",[t._v("然后配置 husky: 在package.json文件中添加:")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"json"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-json"}},[a("code",{pre:!0,attrs:{class:"language-json"}},[a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"husky"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hooks"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pre-commit"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm run lint"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"pre-push"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"npm run lint"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token property"}},[t._v('"commit-msg"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"commitlint -E HUSKY_GIT_PARAMS"')]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 这一行需要配合 commitlint 插件使用")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),a("p",[t._v("配置好后每次 commit 的时候 eslint 都会去检测代码中的语法规范")]),t._v(" "),a("h2",{attrs:{id:"git-commit-message插件-commitline"}},[t._v("git commit message插件: commitline")]),t._v(" "),a("p",[t._v("安装:")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":"shell"}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-shell"}},[a("code",{pre:!0,attrs:{class:"language-shell"}},[t._v("// Install commitlint cli and conventional config\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev @commitlint/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("config-conventional,cli"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n// For Windows:\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --save-dev @commitlint/config-conventional @commitlint/cli\n\n// Configure commitlint to use conventional config\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"module.exports = { extends: ['@commitlint/config-conventional'] }\"")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" commitlint.config.js")])])]),a("p",[t._v("默认使用angularjs 的规范")]),t._v(" "),a("div",{pre:!0,attrs:{class:"saber-highlight","data-lang":""}},[a("pre",{pre:!0,attrs:{class:"saber-highlight-code language-text"}},[a("code",{pre:!0,attrs:{class:"language-text"}},[t._v("// 规范:\nbuild：主要目的是修改项目构建系统(例如 glup，webpack，rollup 的配置等)的提交\nci：主要目的是修改项目继续集成流程(例如 Travis，Jenkins，GitLab CI，Circle等)的提交\ndocs：文档更新\nfeat：新增功能\nmerge：分支合并 Merge branch ? of ?\nfix：bug 修复\nperf：性能, 体验优化\nrefactor：重构代码(既没有新增功能，也没有修复 bug)\nstyle：不影响程序逻辑的代码修改(修改空白字符，格式缩进，补全缺失的分号等，没有改变代码逻辑)\ntest：新增测试用例或是更新现有测试\nrevert：回滚某个更早之前的提交\nchore：不属于以上类型的其他类型")])])])])}),[],!1,null,null,null);"function"==typeof e&&e(r);s.default=r.exports}}]);